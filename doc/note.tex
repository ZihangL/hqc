\documentclass{article}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=1.5cm,right=1.5cm,marginparwidth=1.75cm]{geometry}
\usepackage{amsmath}
\usepackage{braket}
\usepackage{graphicx}
\usepackage{indentfirst}
\setlength{\parindent}{0pt}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{listings}
\lstset{
    columns=fixed,       
    numbers=left,
    frame=none, 
    backgroundcolor=\color[RGB]{245,245,244},
    keywordstyle=\color[RGB]{40,40,255},
    commentstyle=\it\color[RGB]{0,96,96},
    stringstyle=\rmfamily\slshape\color[RGB]{128,0,0},
    showstringspaces=false,
}

\title{Hydrogen note}
\author{Zihang}

\begin{document}
\maketitle
\section{Atomic orbitals}
    Basis set is the starting point of quantum chemistry calculation.
    In general, atomic orbitals are preferred by chemists,
    and plane wave orbitals are preferred by physicists.
    Because atomic orbitals, such as GTOs and STOs, are good for molecules.
    And physicist cares about solid more than molecules.

    In hydrogen problem, PBC atomic orbital maybe a good starting point.
    
    \subsection{Gaussian type orbitals}
        We use Gaussian type orbitals (GTOs) as basis functions.
        The basis we used here, as well as in \href{https://pyscf.org/}{PYSCF},
        is a little bit different from \href{https://www.cp2k.org/basis_sets}{CP2K}.
        Take \href{https://github.com/pyscf/pyscf/blob/master/pyscf/pbc/gto/basis/gth-dzvp.dat}{gth-dzvp} as an example.
        \begin{lstlisting}
            H DZVP-GTH
                2
                1  0  0  4  2
                        8.3744350009  -0.0283380461   0.0000000000
                        1.8058681460  -0.1333810052   0.0000000000
                        0.4852528328  -0.3995676063   0.0000000000
                        0.1658236932  -0.5531027541   1.0000000000
                2  1  1  1  1
                        0.7270000000   1.0000000000
        \end{lstlisting}
        We explain the file-format using in the example.

        \begin{itemize}
            \item[] \textbf{Line 1} are the name of the element and basis set.
            \item[] \textbf{Line 2} specifies the number of sets this basis set contains (here 2).
            \item[] \textbf{Line 3} specifies the composition of the first set.
            \begin{itemize}
                \item[] The first number specifies the principal quantum number (here: 1).
                \item[] The second number specifies the minimal angular quantum number $l_{min}$ (here: 0).
                \item[] The third number specifies the maximal angular quantum number $l_{max}$ (here: 0).
                \item[] The fourth number specifies the number of exponents $N$ (here: 4).
            \end{itemize}
            \item[] The following numbers specify the number of contracted basis functions for each angular momentum value $n_l$ (here only $l=0$).
            \begin{itemize}
                \item[] The fifth number specifies the number of contractions for $l=0$ (here: 2).
            \end{itemize}
            \item[] \textbf{Line 4-7} specify the coefficients of the first set. Each line consists of an exponent $\alpha_j$
            , followed by contraction coefficients $c_{ij}$.
            \item[] \textbf{Line 8} specifies the composition of the second set.
            \item[] \textbf{Line 9} specifies the coefficients of the second set.
        \end{itemize}

        We use the same atomic orbital with \href{https://pyscf.org/}{PYSCF}.

        \begin{equation}
            \varphi_i(\textbf{r}) = N_{\textbf{m}}x^{m_x}y^{m_y}z^{m_z}\sum_{j=1}^NN_{j}c_{ij}\exp\left(-\alpha_{j}\cdot r^2\right)
        \end{equation}

        Where $N_{\textbf{m}}$ and $N_{j}$ are normalization factors.
        So the five bases of hydrogen in the example are as follows,
        ~\\
        \hrule
        $ \varphi_1(\textbf{r}) = \left(\frac{2}{\pi}\right)^{\frac{3}{4}}\left[
            0.028\cdot(8.374)^{\frac{3}{4}}\cdot e^{-8.374r^2}+
            0.133\cdot(1.806)^{\frac{3}{4}}\cdot e^{-1.806r^2}+
            0.400\cdot(0.485)^{\frac{3}{4}}\cdot e^{-0.485r^2}+
            0.553\cdot(0.166)^{\frac{3}{4}}\cdot e^{-0.166r^2}\right] $
 
        $ \varphi_2(\textbf{r}) = \left(\frac{2}{\pi}\right)^{\frac{3}{4}}
            1.000\cdot(0.166)^{\frac{3}{4}}\cdot e^{-0.166r^2} $

        $ \varphi_3(\textbf{r}) = 1.000\cdot x e^{-0.727r^2} $

        $ \varphi_4(\textbf{r}) = 1.000\cdot y e^{-0.727r^2} $

        $ \varphi_5(\textbf{r}) = 1.000\cdot z e^{-0.727r^2} $
        \hrule
        ~\\
        Normalization factors may be different from \href{https://pyscf.org/}{PYSCF}. To be verified.
        
    \subsection{PBC orbitals}
    Crystalline orbitals Gaussian basis function $\phi$ is a lattice sum over local Gaussians $\varphi$
    \begin{equation}
        \phi_{\textbf{k},i}(\textbf{r}) = \sum_{\textbf{T}}e^{i\textbf{k}\cdot\textbf{T}}\varphi_i(\textbf{r}-\textbf{T})\label{ao}
    \end{equation}
    where $\textbf{k}$ is a vector in the first Brillouin zone and $\textbf{T}$ is a lattice translational vector.
    It should be noted that this $\phi_{\textbf{k},i}(\textbf{r})$ is not a periodic function, 
    so PBC here maybe a misleading word, TBC is more accurate.
    According to Bloch's theorem, we have
    \begin{equation}
        \phi_{\textbf{k},i}(\textbf{r}) = e^{i\textbf{k}\cdot\textbf{r}}u_{\textbf{k},i}(\textbf{r})
    \end{equation}
    where $u_{\textbf{k},i}(\textbf{r})$ is fully periodic with respect to all lattice translations.
    Therefore, we can exactly expand the crystalline AOs in a set of auxiliary plane-waves
    \begin{gather}
        \phi_{\textbf{k},i}(\textbf{r}) = \sum_{\textbf{G}}\phi_{\textbf{k},i}(\textbf{G})e^{i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\label{ao_ft}\\
        \phi_{\textbf{k},i}(\textbf{G}) = \frac{1}{\Omega}\int_\Omega d\textbf{r}\ \phi_{\textbf{k},i}(\textbf{r})e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\label{ao_ft_coeff}
    \end{gather}
    In practice, we can get PBC orbitals both from eq.\eqref{ao} and eq.\eqref{ao_ft}. 
    The summations in these two equations are done in a cutoff range.
    To compare the computational complexity of eq.\eqref{ao} and eq.\eqref{ao_ft}, 
    we have to specify the fourier coeffcients by using eq.\eqref{ao_ft_coeff}.
    \begin{align*}
        \phi_{\textbf{k},i}(\textbf{G}) &= \frac{1}{\Omega}\int_\Omega d\textbf{r}\ \phi_{\textbf{k},i}(\textbf{r})e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\\
        &= \frac{1}{\Omega}\int_\Omega d\textbf{r}\ \sum_{\textbf{T}}e^{i\textbf{k}\cdot\textbf{T}}\varphi_i(\textbf{r}-\textbf{T})e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\\
        &= \frac{1}{\Omega}\sum_{\textbf{T}}e^{i\textbf{k}\cdot\textbf{T}}\int_\Omega d\textbf{r}\ \varphi_i(\textbf{r}-\textbf{T})e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\\
        &= \frac{1}{\Omega}\sum_{\textbf{T}}e^{i\textbf{k}\cdot\textbf{T}}\int_{\Omega-\textbf{T}} d\textbf{r}'\ \varphi_i(\textbf{r}')e^{-i(\textbf{k}+\textbf{G})\cdot(\textbf{r}'+\textbf{T})}\\
        &= \frac{1}{\Omega}\sum_{\textbf{T}}\int_{\Omega-\textbf{T}} d\textbf{r}'\ \varphi_i(\textbf{r}')e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}'}\\
        &= \frac{1}{\Omega}\int d\textbf{r}'\ \varphi_i(\textbf{r}')e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}'}
    \end{align*}
    For GTOs, the fourier coeffcients can be performed analytically.
    \begin{equation}
        \phi_{\textbf{k},i}(\textbf{G}) = \frac{1}{\Omega}\int d\textbf{r}\ \varphi_i(\textbf{r})e^{-i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\label{ao_ft_coeff1}
    \end{equation}
    Take a simple s orbital $\varphi(\textbf{r})=e^{-\alpha r^2}$ as an example.
    Using eq.\eqref{ao}, we can get PBC orbitals
    \begin{equation}
        \phi_{\textbf{k}}(\textbf{r}) = \sum_{\textbf{T}}e^{i\textbf{k}\cdot\textbf{T}}e^{-\alpha (\textbf{r}-\textbf{T})^2}\label{7}
    \end{equation}
    On the other hand, the fourier coeffcients from eq.\eqref{ao_ft_coeff1} is
    \begin{equation*}
        \phi_{\textbf{k}}(\textbf{G}) = \frac{1}{\Omega}\left(\frac{\pi}{\alpha}\right)^{\frac{3}{2}}\exp\left[-\frac{(\textbf{k}+\textbf{G})^2}{4\alpha}\right]
    \end{equation*}
    Using eq.\eqref{ao_ft}, we can get PBC orbitals
    \begin{equation}
        \phi_{\textbf{k}}(\textbf{r}) = \frac{1}{\Omega}\left(\frac{\pi}{\alpha}\right)^{\frac{3}{2}}\sum_{\textbf{G}}\exp\left[-\frac{(\textbf{k}+\textbf{G})^2}{4\alpha}\right]e^{i(\textbf{k}+\textbf{G})\cdot\textbf{r}}\label{8}
    \end{equation}
    Compare these two equations eq.\eqref{7} and eq.\eqref{8}, \textbf{we have this conclusion}:
    For large $\alpha$, whose atomic orbital is sharp, directly summation eq.\eqref{ao} has a faster convergence speed,
    and for small $\alpha$, which has gradual atomic orbital, eq.\eqref{ao_ft} has a faster convergence speed.
    

\section{PBC Hartree Fock}
    In this part, we will introduce Hartree Fock method on these PBC orbitals.
    Here we use index $\mu,\nu$ to specify atoms,
    $p,q,r,s$ to specify orbitals of each atom,
    $i,j,k,l$ to specify coeffcients of each orbital,
    $c,d$ to specify cells.
    Then the $p$ th pbc gaussian type orbital of $\mu$ th atom can be described as
    \begin{equation}
        \ket{\textbf{R}_{\textbf{k}\mu p}} = \sum_{i,c}e^{i\textbf{k}\cdot\textbf{T}_c}c_{pi}\ket{\alpha_{i}\textbf{R}_{\mu c}}
    \end{equation}
    Here are some commonly used shorthand symbols.
    \begin{gather*}
        \alpha_{ij} = \frac{\alpha_i\alpha_j}{\alpha_i+\alpha_j} \\
        \alpha_{ij,kl} = \frac{(\alpha_i+\alpha_j)(\alpha_k+\alpha_l)}{\alpha_i+\alpha_j+\alpha_k+\alpha_l} \\
        \textbf{R}_{\mu i,\nu j,c} = \frac{\alpha_i\textbf{R}_{\mu}+\alpha_j\textbf{R}_{\nu,c}}{\alpha_i+\alpha_j}
    \end{gather*}

    \subsection{Integtals}
        General integral on PBC basis is given by
        \begin{align*}
            A_{ij} &= \sum_{m,n}\int_0^T a(x)\chi_i(x+mT)\chi_j(x+nT)dx \\
            &= \sum_{m,n}\int_{mT}^{(m+1)T} a(x'-mT)\chi_i(x')\chi_j[x'+(n-m)T]dx' \\
            &= \sum_{m,n-m}\int_{mT}^{(m+1)T} a(x')\chi_i(x')\chi_j[x'+(n-m)T]dx' \\
            &= \sum_{n'}\int_{-\infty}^{\infty} a(x')\chi_i(x')\chi_j(x'+n'T)dx'
        \end{align*}

        \subsubsection{Overlap}
            The overlap matrix element is given by
            \begin{equation}
                S_{\mu p,\nu q}(\textbf{k}) = \int_{\Omega}d\textbf{r}\ \phi_{\textbf{k},p}^*(\textbf{r}-\textbf{R}_{\mu})\phi_{\textbf{k},q}(\textbf{r}-\textbf{R}_{\nu})
            \end{equation}
            \begin{equation}
                O_{\mu p,\nu q} = \braket{\textbf{R}_{\mu p}|\textbf{R}_{\nu q}} 
                = \sum_c\sum_{ij}c_{pi}c_{qj}(\frac{2\sqrt{\alpha_i\alpha_j}}{\alpha_i+\alpha_j})^{\frac{3}{2}}
                \exp\left[-\alpha_{ij}(\textbf{R}_{\mu}-\textbf{R}_{\nu,c})^2\right]
            \end{equation}
            \begin{equation}
                O_{\mu pi,\nu qj,c} = c_{pi}c_{qj}(\frac{2\sqrt{\alpha_i\alpha_j}}{\alpha_i+\alpha_j})^{\frac{3}{2}}
                \exp\left[-\alpha_{ij}(\textbf{R}_{\mu}-\textbf{R}_{\nu,c})^2\right]
            \end{equation}
            \begin{equation}
                O_{\mu p,\nu q} = \sum_c\sum_{ij}O_{\mu pi,\nu qj,c}
            \end{equation}

        \subsubsection{Kinetic}
            The kinetic matrix element
            \begin{equation}
                T_{\mu p,\nu q} = \bra{\textbf{R}_{\mu p}}-\frac{1}{2}\nabla^2\ket{\textbf{R}_{\nu q}}
                = \sum_c\sum_{ij}c_{pi}c_{qj}(\frac{2\sqrt{\alpha_i\alpha_j}}{\alpha_i+\alpha_j})^{\frac{3}{2}}
                \exp\left[-\alpha_{ij}(\textbf{R}_{\mu}-\textbf{R}_{\nu,c})^2\right]
                \alpha_{ij}\left[3-2\alpha_{ij}(\textbf{R}_{\mu}-\textbf{R}_{\nu,c})^2\right]
            \end{equation}
            \begin{equation}
                T_{\mu p,\nu q} = \sum_c\sum_{ij}O_{\mu pi,\nu qj,c}
                \alpha_{ij}\left[3-2\alpha_{ij}(\textbf{R}_{\mu}-\textbf{R}_{\nu,c})^2\right]
            \end{equation}

        \subsubsection{Potential}
            The potential matrix element
            \begin{equation}
                V_{\mu p,\nu q,N} = \bra{\textbf{R}_{\mu p}}\sum_d\frac{1}{|r-R_{N,d}|}\ket{\textbf{R}_{\nu q}} 
                = 2 \sum_{cd}\sum_{ij}O_{\mu pi,\nu qj,c}\sqrt{\frac{\alpha_i+\alpha_j}{\pi}}
                F_0\left[(\alpha_i+\alpha_j)(\textbf{R}_{N,d}-\textbf{R}_{\mu i,\nu j,c})^2\right]
            \end{equation}
            \begin{equation}
                V_{\mu p,\nu q} = \sum_{\textbf{G}\neq 0}\sum_N\sum_c\sum_{ij}V(\textbf{G})O_{\mu pi,\nu qj,c}
                \exp\left[-i\textbf{G}\cdot(\textbf{R}_N-\textbf{R}_{\mu i,\nu j,c})\right]\exp\left[-\frac{G^2}{4(\alpha_i+\alpha_j)}\right]
            \end{equation}
            where
            \begin{equation}
                V(\textbf{G}) = \frac{4\pi}{L^3}\frac{1}{G^2}
            \end{equation}

        \subsubsection{Electron interaction}
            The interaction matrix element
            \begin{equation}
                E_{p\mu q\nu,r\gamma s\eta} = \bra{\alpha_p\textbf{R}_{\mu}\alpha_q\textbf{R}_{\nu}}
                \frac{1}{|r-r'|}\ket{\alpha_r\textbf{R}_{\gamma}\alpha_s\textbf{R}_{\eta}} 
                = 2 O_{p\mu,r\gamma}O_{q\nu,s\eta}\sqrt{\frac{\alpha_{pr,qs}}{\pi}}
                F_0\left[\alpha_{pr,qs}(\textbf{R}_{p\mu,r\gamma}-\textbf{R}_{q\nu,r\eta})^2\right]
            \end{equation}
            Where
            \begin{equation}
                F_0\left[x\right] = \frac{\sqrt{\pi}erf(\sqrt{x})}{2\sqrt{x}} \quad \& \quad F_0\left[0\right] = 1
            \end{equation}
            
        \subsubsection{Hcore}
            Hamiltonian matrix element without interaction
            \begin{equation}
                h_{p\mu,q\nu} = T_{p\mu,q\nu} - \sum_{N}V_{p\mu,q\nu,N}
            \end{equation}
        \subsubsection{Fock matrix}
            Fock operator matrix element
            \begin{equation}
                F_{p\mu,q\nu} = \bra{\alpha_p\textbf{R}_{\mu}}\hat{H}\ket{\alpha_q\textbf{R}_{\nu}} 
                = h_{p\mu,q\nu} + \sum_{k}\sum_{r\gamma,s\eta} 
                (2E_{p\mu r\gamma,q\nu s\eta}-E_{p\mu r\gamma,s\eta q\nu})C_{r\gamma,k}^*C_{s\eta,k}
            \end{equation}

    \subsection{Solution of Roothaan equation}
        Roothaan equation
        \begin{equation}
            \textbf{FC}_k = \epsilon_k\textbf{SC}_k
        \end{equation}
        Energy
        \begin{equation}
            E_g = 2\sum_k\sum_{p\mu,q\nu}h_{p\mu,q\nu}C_{p\mu,k}^*C_{q\nu,k}+
            \sum_k\sum_{p\mu,q\nu,r\gamma,s\eta}(2E_{p\mu r\gamma,q\nu s\eta}-
            E_{p\mu r\gamma,s\eta q\nu})C_{p\mu,k}^*C_{q\nu,k}C_{r\gamma,k}^*C_{s\eta,k}
        \end{equation}
        
\section{Molecule orbitals}

\section{Wave function}

\section{Density}

\section{Gradient logpsi}

\section{Laplacian logpsi}

\section*{Notation}


\end{document}